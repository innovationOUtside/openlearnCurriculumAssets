
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Working With Figures and Media Items &#8212; Working With OpenLearn Curriculum Assets</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Working With Equations" href="equations.html" />
    <link rel="prev" title="Working With Activities, Exercises, ITQs and SAQs" href="activity.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Working With OpenLearn Curriculum Assets</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Foundations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="scraping_openlearn.html">
   Scraping OpenLearn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ouxml-intro.html">
   A Quick Overview of OU-XML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working-with-ouxml.html">
   Working With OU-XML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="datasette-ui.html">
   Querying the Database With
   <code class="docutils literal notranslate">
    <span class="pre">
     datasette
    </span>
   </code>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Towards An OU-XML Curriculum Asset Bank
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="learning_outcomes.html">
   Working With Learning Outcomes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glossary.html">
   Working With Glossary Items
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="activity.html">
   Working With Activities, Exercises, ITQs and SAQs
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Working With Figures and Media Items
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="equations.html">
   Working With Equations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Unit Mapping
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index_maps.html">
   Unit Mapping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ouxml-quality-audit.html">
   OU-XML Health Checks and Quality Audits
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/media_items.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparing-the-ground">
   Preparing the Ground
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extracting-figure-items">
   Extracting
   <code class="docutils literal notranslate">
    <span class="pre">
     Figure
    </span>
   </code>
   Items
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-figure-items-to-the-database">
     Adding Figure Items to the Database
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extracting-mediacontent-items">
   Extracting
   <code class="docutils literal notranslate">
    <span class="pre">
     MediaContent
    </span>
   </code>
   Items
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-media-item-metadata-to-the-database">
     Adding Media Item Metadata to the Database
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Working With Figures and Media Items</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparing-the-ground">
   Preparing the Ground
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extracting-figure-items">
   Extracting
   <code class="docutils literal notranslate">
    <span class="pre">
     Figure
    </span>
   </code>
   Items
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-figure-items-to-the-database">
     Adding Figure Items to the Database
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extracting-mediacontent-items">
   Extracting
   <code class="docutils literal notranslate">
    <span class="pre">
     MediaContent
    </span>
   </code>
   Items
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-media-item-metadata-to-the-database">
     Adding Media Item Metadata to the Database
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="working-with-figures-and-media-items">
<h1>Working With Figures and Media Items<a class="headerlink" href="#working-with-figures-and-media-items" title="Permalink to this headline">#</a></h1>
<p>When working with images in course production, there are several approaches we may take:</p>
<ul class="simple">
<li><p>discovering and reusing images and diagrams that already exist in order to illustrate a topic; example images may be selected by an author either with the intention that rights clearance (if required) is obtained for using that image, or that image may be used as a prompt to a picure researcher to find an image with a similar sense;</p></li>
<li><p>discovering images and diagrams based on a description of an image that is intended to serve a particular effect; recent advances in the automated generation of images from free text descriptions (e.g. StableDiffusion, DALL-E) may offer interesting possibilties here, either by generating images that can be used directly or by generating images that can be used as prompts by picture researchers;</p></li>
<li><p>using scientific or mathematical charts and diagrams generated by scientific software (<a class="reference external" href="https://opencomputinglab.github.io/SubjectMatterNotebooks/chart/overview.html">example</a>). In these cases, whilst the <em>detail</em> of the diagram may be important (data points are in the correct locations), the <em>style</em> of the diagram may be subject to artistic or desgin considerations;</p></li>
<li><p>generating diagrams using strict syntax diagram generation tools: for example, generating box and arrow diagrams or flow charts from a simple text descriptions; (see for example <a class="reference external" href="https://opencomputinglab.github.io/SubjectMatterNotebooks/diagram/blockdiag.html"><em>Generating Diagrams from Text Using BlockDiag</em></a>).</p></li>
</ul>
<p>The OU-XML document structure supports the description of figures, which is to say, images, as well as various media file types, such as audio and video asset types. In this section, we will see how we can support media discovery across the OpenLearn units by means of a simple full-text search over media captions and transcripts. THe availability of figure descriptions also provides us with a corpus of text descriptions that it might to interesting to run through image-from-text generation tools to see what sorts of things they come up with, and how text prompts need to be phrased to generate something resembling the intended effect.</p>
<p><em>For now, the actual media assets (images, videos, audio files, etc.), will <em>not</em> be scraped or added to the database. This means that media assets can be searched for, but not directly rendered.</em></p>
<section id="preparing-the-ground">
<h2>Preparing the Ground<a class="headerlink" href="#preparing-the-ground" title="Permalink to this headline">#</a></h2>
<p>As ever, we need to set up a database connection:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlite_utils</span> <span class="kn">import</span> <span class="n">Database</span>

<span class="c1"># Open database connection</span>
<span class="n">dbname</span> <span class="o">=</span> <span class="s2">&quot;all_openlean_xml.db&quot;</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">Database</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And get a sample XML file, selecting one that we know contains struturally marked up glossary items:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Grab an OU-XML file that is known to contain glossary items</span>
<span class="n">a210_xml_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT xml FROM xml WHERE code=&#39;A111&#39;&quot;</span><span class="p">,</span>
                           <span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;xml&quot;</span><span class="p">]</span>

<span class="c1"># Parse the XML into an xml object</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">a210_xml_raw</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s also import a couple of utlilty functions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xml_utils</span> <span class="kn">import</span> <span class="n">flatten</span><span class="p">,</span> <span class="n">unpack</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="extracting-figure-items">
<h2>Extracting <code class="docutils literal notranslate"><span class="pre">Figure</span></code> Items<a class="headerlink" href="#extracting-figure-items" title="Permalink to this headline">#</a></h2>
<p>Image references are provided inside a <code class="docutils literal notranslate"><span class="pre">&lt;Figure&gt;</span></code> element [<a class="reference external" href="https://learn3.open.ac.uk/mod/oucontent/view.php?id=185747%C2%A7ion=8.4.4">docs</a>]. This structured element type also bundles a caption and a description:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Figure&gt;</span>
    <span class="nt">&lt;Image</span> <span class="na">src=</span><span class="s">&quot;https://www.open.edu/openlearn/ocw/pluginfile.php/1407405/mod_oucontent/oucontent/72913/a111_1_openlearn_piano.tif&quot;</span> <span class="na">x_printonly=</span><span class="s">&quot;y&quot;</span> <span class="na">x_folderhash=</span><span class="s">&quot;5c95a855&quot;</span> <span class="na">x_contenthash=</span><span class="s">&quot;d74c57b3&quot;</span> <span class="na">x_imagesrc=</span><span class="s">&quot;a111_1_openlearn_piano.tif.jpg&quot;</span> <span class="na">x_imagewidth=</span><span class="s">&quot;512&quot;</span> <span class="na">x_imageheight=</span><span class="s">&quot;325&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Caption&gt;&lt;b&gt;</span>Figure<span class="nt">&lt;/b&gt;</span> 10 Playing the blues<span class="nt">&lt;/Caption&gt;</span>
    <span class="nt">&lt;Description&gt;</span>This is a photograh showing a person\&#39;s hands playing the piano.<span class="nt">&lt;/Description&gt;</span>
<span class="nt">&lt;/Figure&gt;</span>
</pre></div>
</div>
<p>An <code class="docutils literal notranslate"><span class="pre">&lt;Alternative&gt;</span></code> text tag may also be included.</p>
<p>To support discovery of figure items in a particular context, it will be useful to save the XML <em>path</em> to the figure elements. We can then use this as a basis for identifying whether a figure is used in an activity context, for example.</p>
<p>We can obtain the path to an element by generating a document tree and the locating a particular element within that structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate the tree structure</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

<span class="c1"># Get example figure item</span>
<span class="n">test_figure</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&quot;//Figure&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Find the path to a figure item</span>
<span class="n">tree</span><span class="o">.</span><span class="n">getpath</span><span class="p">(</span><span class="n">test_figure</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/Item/Unit/Session[1]/Figure&#39;
</pre></div>
</div>
</div>
</div>
<p>We can use a regular expression replacement to tidy the path up to remove the index values and give us a raw context path:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">context_path</span><span class="p">(</span><span class="n">xpath</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simplify an xpath to give a cleaner context path.&quot;&quot;&quot;</span>
    <span class="n">xpath</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\[\d+\]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span>
    <span class="n">xpath</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(/Item|/Unit|/Session|/Section|/SubSection|/InternalSection)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xpath</span>
</pre></div>
</div>
</div>
</div>
<p>For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">context_path</span><span class="p">(</span><span class="s1">&#39;/Item/Unit[7]/Session[3]/Activity[1]/Question/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/Activity/Question/&#39;
</pre></div>
</div>
</div>
</div>
<p>Let’s now create a function that grabs data from a figure element that we can use to support figure discovery and audit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_figure_items</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract figure items from an OU-XML XML object.&quot;&quot;&quot;</span>
    <span class="n">figures</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//Figure&#39;</span><span class="p">)</span>
    
    <span class="c1"># We use the tree to find the path to the figure element</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    
    <span class="c1"># ist of media items in a unit</span>
    <span class="n">figure_items</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">figure_urls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">figures</span><span class="p">:</span>
        <span class="n">f_url</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Image&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">)</span>
        <span class="c1"># If there is no image reference, do not save this item</span>
        <span class="c1"># TO DO: should we warn if there is other figure data but no url?</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f_url</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># If the same figure element appears multiple times in a unit</span>
        <span class="c1"># we only want to save it once.</span>
        <span class="c1"># TO DO: we should probably check multiple instances to ensure</span>
        <span class="c1">#        that the other elements (eg descriptions) are consistent.</span>
        <span class="k">if</span> <span class="n">f_url</span> <span class="ow">in</span> <span class="n">figure_urls</span><span class="p">:</span>
            <span class="c1"># Optionally report on the duplicate items - useful for debugging</span>
            <span class="c1">#print(f&quot;Duplicate item {f_url} — duplicate not checked or stored.&quot;)</span>
            <span class="c1"># Don&#39;t extract the duplicate</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">figure_urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_url</span><span class="p">)</span>

        <span class="n">f_type</span> <span class="o">=</span> <span class="n">f_url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tmp_caption</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&quot;Caption&quot;</span><span class="p">)</span>
        <span class="n">f_caption</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">tmp_caption</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">tmp_caption</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">tmp_alt</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&quot;Alternative&quot;</span><span class="p">)</span>
        <span class="n">f_alt</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">tmp_alt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">tmp_alt</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">tmp_desc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">)</span>
        <span class="n">f_desc</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">tmp_desc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">tmp_desc</span> <span class="k">else</span> <span class="kc">None</span>
        
        <span class="c1"># Get the path the the figure element</span>
        <span class="n">f_xpath</span> <span class="o">=</span> <span class="n">context_path</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">getpath</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
        
        <span class="n">figure_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">f_type</span><span class="p">,</span> <span class="n">f_url</span><span class="p">,</span> <span class="n">f_caption</span><span class="p">,</span> <span class="n">f_alt</span><span class="p">,</span> <span class="n">f_desc</span><span class="p">,</span> <span class="n">f_xpath</span><span class="p">)</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">figure_items</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_figure_items</span><span class="p">(</span><span class="n">root</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;tif&#39;,
  &#39;https://www.open.edu/openlearn/ocw/pluginfile.php/1407405/mod_oucontent/oucontent/72913/a111_1_f01.tif&#39;,
  &#39;Figure 1 B. B. King performing c.1968. Photo Michael Ochs Archives/Getty Images (via Britannica Image Quest)&#39;,
  None,
  &#39;This is a photograph of B. B. King playing the guitar on stage.&#39;,
  &#39;/Figure&#39;),
 (&#39;tif&#39;,
  &#39;https://www.open.edu/openlearn/ocw/pluginfile.php/1407405/mod_oucontent/oucontent/72913/a111_1_openlearn_beatles.tif&#39;,
  &#39;Figure 2 The music of the Beatles&#39;,
  None,
  &#39;This is an image showing a number of records by the Beatles.&#39;,
  &#39;/Figure&#39;)]
</pre></div>
</div>
</div>
</div>
<section id="adding-figure-items-to-the-database">
<h3>Adding Figure Items to the Database<a class="headerlink" href="#adding-figure-items-to-the-database" title="Permalink to this headline">#</a></h3>
<p>To support discovery, we can add figure item captions, descriptions and alternative text to a simple database table and then provide full-test search over them.</p>
<p><em>For now, we will omit scraping the figure assets into the database. An example of how to add a mdia item to the database, as well as retrieve and render a media item, is provided in the <code class="docutils literal notranslate"><span class="pre">Scraping</span> <span class="pre">OpenLearn</span></code> section.</em></p>
<p>Let’s define a simple table to store this information, along with an associated full-text search table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_figures_tbl</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="s2">&quot;figures&quot;</span><span class="p">]</span>
<span class="n">all_figures_tbl</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">ignore</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">all_figures_tbl</span><span class="o">.</span><span class="n">create</span><span class="p">({</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;caption&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;alt&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;xpath&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">},</span> <span class="n">pk</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>

<span class="c1"># Enable full text search</span>
<span class="c1"># This creates an extra virtual table (media_fts) to support the full text search</span>
<span class="n">db</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">all_figures_tbl</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_fts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">ignore</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">db</span><span class="p">[</span><span class="n">all_figures_tbl</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">enable_fts</span><span class="p">([</span><span class="s2">&quot;caption&quot;</span><span class="p">,</span> <span class="s2">&quot;alt&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">create_triggers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Table figures (type, caption, alt, description, xpath, code, name, url, id, _id)&gt;
</pre></div>
</div>
</div>
</div>
<p>Now we can populate the table with our figure assets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xml_utils</span> <span class="kn">import</span> <span class="n">create_id</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT * FROM xml;&quot;&quot;&quot;</span><span class="p">):</span>
    <span class="n">_root</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;xml&quot;</span><span class="p">])</span>
    <span class="n">figure_items</span> <span class="o">=</span> <span class="n">get_figure_items</span><span class="p">(</span><span class="n">_root</span><span class="p">)</span>
    <span class="c1"># From the list of media items,</span>
    <span class="c1"># create a list of dict items we can add to the database</span>
    <span class="n">figure_item_dicts</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                         <span class="s2">&quot;caption&quot;</span><span class="p">:</span> <span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;alt&quot;</span><span class="p">:</span> <span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                          <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;xpath&quot;</span><span class="p">:</span> <span class="n">f</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
                         <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">],</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">figure_items</span> <span class="k">if</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span>

    <span class="c1"># Add a unique id for each record</span>
    <span class="n">create_id</span><span class="p">(</span><span class="n">figure_item_dicts</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">])</span>
    <span class="c1"># And a cross reference id for each record</span>
    <span class="n">create_id</span><span class="p">(</span><span class="n">figure_item_dicts</span><span class="p">,</span> <span class="n">id_field</span><span class="o">=</span><span class="s2">&quot;_id&quot;</span><span class="p">)</span>
        
    <span class="c1"># Add items to the database</span>
    <span class="n">db</span><span class="p">[</span><span class="n">all_figures_tbl</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">insert_all</span><span class="p">(</span><span class="n">figure_item_dicts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s see what image types are referenced across the OpenLearn units:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT DISTINCT(type) FROM figures&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>jpg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>tif</td>
    </tr>
    <tr>
      <th>2</th>
      <td>png</td>
    </tr>
    <tr>
      <th>3</th>
      <td>eps</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gif</td>
    </tr>
    <tr>
      <th>5</th>
      <td>mp4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>What sort of context to the fugures appear in terms of their path locations within the OU-XML documents?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT DISTINCT(xpath) FROM figures&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>xpath</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/Figure</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/Activity/Question/Figure</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/Activity/Discussion/Figure</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/Activity/Multipart/Part/Question/Figure</td>
    </tr>
    <tr>
      <th>5</th>
      <td>/Activity/Multipart/Figure</td>
    </tr>
    <tr>
      <th>6</th>
      <td>/Activity/Multipart/Part/Question/Table/tbody/...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>/Activity/Question/Reading/Figure</td>
    </tr>
    <tr>
      <th>8</th>
      <td>/Activity/Answer/Figure</td>
    </tr>
    <tr>
      <th>9</th>
      <td>/Box/Figure</td>
    </tr>
    <tr>
      <th>10</th>
      <td>/SAQ/Answer/Figure</td>
    </tr>
    <tr>
      <th>11</th>
      <td>/Activity/Multipart/Part/Answer/Figure</td>
    </tr>
    <tr>
      <th>12</th>
      <td>/Activity/Multipart/Part/Question/MediaContent...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>/Activity/Question/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>14</th>
      <td>/FrontMatter/Introduction/Figure</td>
    </tr>
    <tr>
      <th>15</th>
      <td>/Activity/Discussion/Extract/Figure</td>
    </tr>
    <tr>
      <th>16</th>
      <td>/SAQ/Question/Figure</td>
    </tr>
    <tr>
      <th>17</th>
      <td>/NumberedList/ListItem/Figure</td>
    </tr>
    <tr>
      <th>18</th>
      <td>/CaseStudy/Figure</td>
    </tr>
    <tr>
      <th>19</th>
      <td>/Activity/Multipart/Part/Question/NumberedList...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>/Introduction/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>21</th>
      <td>/Activity/Multipart/Part/Discussion/Figure</td>
    </tr>
    <tr>
      <th>22</th>
      <td>/FrontMatter/Introduction/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>23</th>
      <td>/StudyNote/Figure</td>
    </tr>
    <tr>
      <th>24</th>
      <td>/Extract/Figure</td>
    </tr>
    <tr>
      <th>25</th>
      <td>/Activity/Question/UnNumberedList/ListItem/Figure</td>
    </tr>
    <tr>
      <th>26</th>
      <td>/Activity/Multipart/Part/Question/Reading/Figure</td>
    </tr>
    <tr>
      <th>27</th>
      <td>/Activity/Multipart/Part/Question/Reading/Read...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>/Introduction/Figure</td>
    </tr>
    <tr>
      <th>29</th>
      <td>/Activity/Question/CaseStudy/Figure</td>
    </tr>
    <tr>
      <th>30</th>
      <td>/SAQ/Discussion/Figure</td>
    </tr>
    <tr>
      <th>31</th>
      <td>/Activity/Question/Extract/Figure</td>
    </tr>
    <tr>
      <th>32</th>
      <td>/Box/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>33</th>
      <td>/Table/tbody/tr/td/Figure</td>
    </tr>
    <tr>
      <th>34</th>
      <td>/Example/Figure</td>
    </tr>
    <tr>
      <th>35</th>
      <td>/Example/Answer/Figure</td>
    </tr>
    <tr>
      <th>36</th>
      <td>/ITQ/Answer/Figure</td>
    </tr>
    <tr>
      <th>37</th>
      <td>/Activity/Answer/Box/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>38</th>
      <td>/Activity/Answer/Box/Figure</td>
    </tr>
    <tr>
      <th>39</th>
      <td>/Activity/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>40</th>
      <td>/Activity/Multipart/Part/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>41</th>
      <td>/Activity/Multipart/Part/Question/Box/Figure</td>
    </tr>
    <tr>
      <th>42</th>
      <td>/Activity/Question/Box/Figure</td>
    </tr>
    <tr>
      <th>43</th>
      <td>/Activity/Question/Box/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>44</th>
      <td>/Activity/Discussion/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>45</th>
      <td>/Activity/Discussion/NumberedList/ListItem/Figure</td>
    </tr>
    <tr>
      <th>46</th>
      <td>/ITQ/Question/Figure</td>
    </tr>
    <tr>
      <th>47</th>
      <td>/BulletedList/ListItem/Figure</td>
    </tr>
    <tr>
      <th>48</th>
      <td>/SubSubSection/Figure</td>
    </tr>
    <tr>
      <th>49</th>
      <td>/SubSubSection/Activity/Question/Figure</td>
    </tr>
    <tr>
      <th>50</th>
      <td>/SubSubSection/Activity/Discussion/Figure</td>
    </tr>
    <tr>
      <th>51</th>
      <td>/FrontMatter/Introduction/Activity/Question/Me...</td>
    </tr>
    <tr>
      <th>52</th>
      <td>/Activity/Multipart/Part/Answer/NumberedList/L...</td>
    </tr>
    <tr>
      <th>53</th>
      <td>/Activity/Question/Quote/Figure</td>
    </tr>
    <tr>
      <th>54</th>
      <td>/Activity/Multipart/MultiColumnText/MultiColum...</td>
    </tr>
    <tr>
      <th>55</th>
      <td>/SAQ/Question/MediaContent/Figure</td>
    </tr>
    <tr>
      <th>56</th>
      <td>/MediaContent/Description/Figure</td>
    </tr>
    <tr>
      <th>57</th>
      <td>/Box/BulletedList/ListItem/Figure</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s also try a full-text search over all the images referenced from OU-XML documents:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xml_utils</span> <span class="kn">import</span> <span class="n">fts</span>

<span class="n">fts</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="s2">&quot;figures&quot;</span><span class="p">,</span> <span class="s2">&quot;protest&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>caption</th>
      <th>alt</th>
      <th>description</th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Figure 5 Policing and the right to protest</td>
      <td>None</td>
      <td>A line of uniformed police officers standing o...</td>
      <td>05bce9978659e418b36040e8590996e2f116edaf</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Figure 1 Climate change protesters near the Br...</td>
      <td>None</td>
      <td>A young person holding up a placard during a p...</td>
      <td>28c921f9786fd2f6e625eb1369ef5462b7805738</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Figure 3 Left, a sculpture of Baartman at the ...</td>
      <td>On the left is a photograph of a sculpture of ...</td>
      <td>On the left is a photograph of a sculpture of ...</td>
      <td>68045d707309f11a19ab4f45286d1c5daaae783b</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Figure 4</td>
      <td>None</td>
      <td>A trade union protest, with the people holding...</td>
      <td>8b9f5e88187ec0cd0e2f40ccc8f936da4e0c500e</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Figure 12: Emma Gonzalez (centre right) at a M...</td>
      <td>None</td>
      <td>A photograph of Emma Gonzalez (centre right) a...</td>
      <td>6721a0c5b3566e937bce11c79b3f06958a8bac7c</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Figure 4</td>
      <td>None</td>
      <td>A trade union protest, with the people holding...</td>
      <td>604d1ca213c5850b1e6e683993e3ee766e9da20d</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we grabbed the image assets themselves into the database, or if we can resolve the URLs to the images, we could provide a gallery view over the images, or return visual images as part of our search results.</p>
</section>
</section>
<section id="extracting-mediacontent-items">
<h2>Extracting <code class="docutils literal notranslate"><span class="pre">MediaContent</span></code> Items<a class="headerlink" href="#extracting-mediacontent-items" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">MediaContent</span></code> element [<a class="reference external" href="https://learn3.open.ac.uk/mod/oucontent/view.php?id=185747%C2%A7ion=8.4.7">docs</a>] provides a strcutured way of describing audio and video media assets as well as other asset types.</p>
<p>For example, a minimal decription of audio asset might be provided as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;MediaContent</span> <span class="na">src=</span><span class="s">&quot;https://www.open.edu/openlearn/ocw/pluginfile.php/1407405/mod_oucontent/oucontent/72913/a111_2019j_aug123_00.00-00.37.mp3&quot;</span> <span class="na">type=</span><span class="s">&quot;audio&quot;</span> <span class="na">x_manifest=</span><span class="s">&quot;a111_2019j_aug123_00.00-00.37_1_server_manifest.xml&quot;</span> <span class="na">x_filefolderhash=</span><span class="s">&quot;ae00f4bb&quot;</span> <span class="na">x_folderhash=</span><span class="s">&quot;ae00f4bb&quot;</span> <span class="na">x_contenthash=</span><span class="s">&quot;fbeac38a&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Caption&gt;</span>Audio 1 Robert Petway<span class="nt">&lt;/Caption&gt;</span>
<span class="nt">&lt;/MediaContent&gt;</span>
</pre></div>
</div>
<p>Video assets are also described using the <code class="docutils literal notranslate"><span class="pre">&lt;MediaContent&gt;</span></code> tag, the <code class="docutils literal notranslate"><span class="pre">type=</span></code> attribute being used to distinguish the media type. The <code class="docutils literal notranslate"><span class="pre">&lt;MediaContent&gt;</span></code> element includes a <code class="docutils literal notranslate"><span class="pre">&lt;Transcript&gt;</span></code> element that can be used to package a transcript alongside the referenced mdia item.</p>
<p>The following fragment also shows how an additional figure element can be included in the <code class="docutils literal notranslate"><span class="pre">&lt;MediaContent&gt;</span></code> element; this may be used to display “cover art” associated with the asset, for example.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;MediaContent</span> <span class="na">src=</span><span class="s">&quot;https://www.open.edu/openlearn/ocw/pluginfile.php/1407405/mod_oucontent/oucontent/72913/a111_2019j_vid004-640x360.mp4&quot;</span> <span class="na">type=</span><span class="s">&quot;video&quot;</span> <span class="na">width=</span><span class="s">&quot;512&quot;</span> <span class="na">x_manifest=</span><span class="s">&quot;a111_2019j_vid004_1_server_manifest.xml&quot;</span> <span class="na">x_filefolderhash=</span><span class="s">&quot;ae00f4bb&quot;</span> <span class="na">x_folderhash=</span><span class="s">&quot;ae00f4bb&quot;</span> <span class="na">x_contenthash=</span><span class="s">&quot;bd2d0a18&quot;</span> <span class="na">x_subtitles=</span><span class="s">&quot;a111_2019j_vid004-640x360.srt&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Caption&gt;</span>Video 1<span class="nt">&lt;/Caption&gt;</span>
    <span class="nt">&lt;Transcript&gt;</span>...<span class="nt">&lt;/Transcript&gt;</span>
    <span class="nt">&lt;Figure&gt;</span>
        <span class="nt">&lt;Image</span> <span class="na">src=</span><span class="s">&quot;https://www.open.edu/openlearn/ocw/pluginfile.php/1407405/mod_oucontent/oucontent/72913/a111_2019j_vid004_poster_image.jpg&quot;</span> <span class="na">x_folderhash=</span><span class="s">&quot;ae00f4bb&quot;</span> <span class="na">x_contenthash=</span><span class="s">&quot;02a6127c&quot;</span> <span class="na">x_imagesrc=</span><span class="s">&quot;a111_2019j_vid004_poster_image.jpg&quot;</span> <span class="na">x_imagewidth=</span><span class="s">&quot;512&quot;</span> <span class="na">x_imageheight=</span><span class="s">&quot;288&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/Figure&gt;</span>
<span class="nt">&lt;/MediaContent&gt;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_media_items</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract media content items from an OU-XML XML object.&quot;&quot;&quot;</span>
    <span class="n">media</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//MediaContent&#39;</span><span class="p">)</span>
    
    <span class="c1"># We use the tree to find the path to the figure element</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    
    <span class="c1"># ist of media items in a unit</span>
    <span class="n">media_items</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">media_urls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">media</span><span class="p">:</span>
        <span class="n">m_url</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">)</span>
        
        <span class="c1"># If the same media element appears multiple times in a unit</span>
        <span class="c1"># we only want to save it once.</span>
        <span class="c1"># TO DO: we should probably check multiple instances to ensure</span>
        <span class="c1">#        that the other elements (eg transcript) are consistent.</span>
        <span class="k">if</span> <span class="n">m_url</span> <span class="ow">in</span> <span class="n">media_urls</span><span class="p">:</span>
            <span class="c1"># Optionally report on the duplicate items - useful for debugging</span>
            <span class="c1">#print(f&quot;Duplicate item {m_url} — duplicate not checked or stored.&quot;)</span>
            <span class="c1"># Don&#39;t extract the duplicate</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">media_urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_url</span><span class="p">)</span>

        <span class="n">m_type</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
        <span class="n">tmp_caption</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&quot;Caption&quot;</span><span class="p">)</span>
        <span class="n">m_caption</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">tmp_caption</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">tmp_caption</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">tmp_transcript</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&quot;Transcript&quot;</span><span class="p">)</span>
        <span class="n">m_transcript</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">tmp_transcript</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">tmp_transcript</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">tmp_desc</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">)</span>
        <span class="n">m_desc</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">tmp_desc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">tmp_desc</span> <span class="k">else</span> <span class="kc">None</span>
        
        <span class="c1"># Get the path the the figure element</span>
        <span class="n">m_xpath</span> <span class="o">=</span> <span class="n">context_path</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">getpath</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
        
        <span class="c1">#ET.tostring(xml, encoding=&#39;unicode&#39;) #.decode() </span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">m_type</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">media_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">m_type</span><span class="p">,</span> <span class="n">m_url</span><span class="p">,</span> <span class="n">m_caption</span><span class="p">,</span> <span class="n">m_transcript</span><span class="p">,</span> <span class="n">m_desc</span><span class="p">,</span> <span class="n">m_xpath</span><span class="p">)</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">media_items</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_media_items</span><span class="p">(</span><span class="n">root</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;audio&#39;,
  &#39;https://www.open.edu/openlearn/ocw/pluginfile.php/1407405/mod_oucontent/oucontent/72913/a111_2019j_aug123_00.00-00.37.mp3&#39;,
  &#39;Audio 1 Robert Petway&#39;,
  None,
  None,
  &#39;/Activity/Question/MediaContent&#39;),
 (&#39;audio&#39;,
  &#39;https://www.open.edu/openlearn/ocw/pluginfile.php/1407405/mod_oucontent/oucontent/72913/a111_2019j_aug113_00.00-00.35.mp3&#39;,
  &#39;Audio 2 Muddy Waters&#39;,
  None,
  None,
  &#39;/Activity/Question/MediaContent&#39;)]
</pre></div>
</div>
</div>
</div>
<section id="adding-media-item-metadata-to-the-database">
<h3>Adding Media Item Metadata to the Database<a class="headerlink" href="#adding-media-item-metadata-to-the-database" title="Permalink to this headline">#</a></h3>
<p>To support discovery, we can add media item captions and transcripts to a simple database table and then provide full-test search over them.</p>
<p><em>For now, we will omit scraping the media assets into the database. An example of how to add a mdia item to the database, as well as retrieve and render a media item, is provided in the <code class="docutils literal notranslate"><span class="pre">Scraping</span> <span class="pre">OpenLearn</span></code> section.</em></p>
<p>Let’s define a simple table to store this information, along with an associated full-text search table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_media_tbl</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="s2">&quot;media&quot;</span><span class="p">]</span>
<span class="n">all_media_tbl</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">ignore</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">all_media_tbl</span><span class="o">.</span><span class="n">create</span><span class="p">({</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;caption&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;transcript&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;xpath&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">},</span> <span class="n">pk</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>
<span class="c1"># Note: we might also want to include a way of referencing</span>
<span class="c1"># any associated cover art, or at least flag the existence</span>
<span class="c1"># of an associated figure containd in the media element structure</span>

<span class="c1"># Enable full text search</span>
<span class="c1"># This creates an extra virtual table (media_fts) to support the full text search</span>
<span class="n">db</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">all_media_tbl</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_fts&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">ignore</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">db</span><span class="p">[</span><span class="n">all_media_tbl</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">enable_fts</span><span class="p">([</span><span class="s2">&quot;caption&quot;</span><span class="p">,</span> <span class="s2">&quot;transcript&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">create_triggers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Table media (type, caption, transcript, description, xpath, code, name, url, id, _id)&gt;
</pre></div>
</div>
</div>
</div>
<p>Now we can iterate over all the OU-XML documents, extract any media items contained therein, and add them to our database table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT * FROM xml;&quot;&quot;&quot;</span><span class="p">):</span>
    <span class="n">_root</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;xml&quot;</span><span class="p">])</span>
    <span class="n">media_items</span> <span class="o">=</span> <span class="n">get_media_items</span><span class="p">(</span><span class="n">_root</span><span class="p">)</span>
    <span class="c1"># From the list of media items,</span>
    <span class="c1"># create a list of dict items we can add to the database</span>
    <span class="n">media_item_dicts</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                         <span class="s2">&quot;caption&quot;</span><span class="p">:</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;transcript&quot;</span><span class="p">:</span> <span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                         <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;xpath&quot;</span><span class="p">:</span> <span class="n">m</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
                         <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">],</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">media_items</span> <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span>
    
    <span class="c1"># Add a unique id for each record</span>
    <span class="n">create_id</span><span class="p">(</span><span class="n">media_item_dicts</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">])</span>
    <span class="c1"># And a cross reference id for each record</span>
    <span class="n">create_id</span><span class="p">(</span><span class="n">media_item_dicts</span><span class="p">,</span> <span class="n">id_field</span><span class="o">=</span><span class="s2">&quot;_id&quot;</span><span class="p">)</span>
    
    <span class="c1"># Add items to the database</span>
    <span class="n">db</span><span class="p">[</span><span class="n">all_media_tbl</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">insert_all</span><span class="p">(</span><span class="n">media_item_dicts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s review what types of media assets there are from across the OpenLearn units:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;SELECT DISTINCT(type) FROM media&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>video</td>
    </tr>
    <tr>
      <th>1</th>
      <td>html5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>audio</td>
    </tr>
    <tr>
      <th>3</th>
      <td>file</td>
    </tr>
    <tr>
      <th>4</th>
      <td>embed</td>
    </tr>
    <tr>
      <th>5</th>
      <td>moodlequestion</td>
    </tr>
    <tr>
      <th>6</th>
      <td>openmark</td>
    </tr>
    <tr>
      <th>7</th>
      <td>flash</td>
    </tr>
    <tr>
      <th>8</th>
      <td>oembed</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>How about a full text search over the media asset captions and transcripts?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fts</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="s2">&quot;media&quot;</span><span class="p">,</span> <span class="s2">&quot;communication web&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>caption</th>
      <th>transcript</th>
      <th>description</th>
      <th>type</th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>None</td>
      <td>SPEAKER\n                    Vinton Cerf is vi...</td>
      <td>None</td>
      <td>audio</td>
      <td>e0389de262a92186c872a5e7a2619c4809eb0b7b</td>
    </tr>
    <tr>
      <th>1</th>
      <td>None</td>
      <td>REBECCA FIELDING:  The key skills and attribut...</td>
      <td>None</td>
      <td>video</td>
      <td>46ba32530064312d4275661b793801387109fb84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>None</td>
      <td>MartinWe’re live. OK guys, thanks for joining ...</td>
      <td>None</td>
      <td>embed</td>
      <td>c40e38ef5dd5afb8213642aa63cae5eb7d0c9315</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="activity.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Working With Activities, Exercises, ITQs and SAQs</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="equations.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Working With Equations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Tony Hirst<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>